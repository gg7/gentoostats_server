{% extends "stats/base.html" %}
{% load url from future %}

{% block title %}Overall Statistics | Gentoostats {% endblock title %}

{% block content %}
    <h1>Overall statistics</h1>

    {% if hosts.count %}
    <ul>
        <li>Total hosts: {{ hosts.count }}</li>
        {% if country_stats %}
            <li>Country statistics:</li>
            <table border="1">
                <th>Country</th>
                <th>Hosts</th>
                {% for country, num_hosts in country_stats %}
                    <tr>
                        <td>{{ country|default_if_none:"Unknown" }}</td>
                        <td>{{ num_hosts }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}

        <li>Total submissions: {{ submissions.count }}</li>
        <li>Latest submissions:</li>
        <ul>
            {% for submission in submissions|slice:":10" reversed %}
                <li><a href="{{ submission.get_absolute_url }}">[{{ submission.datetime|date:"Y.m.d H:i" }}] ARCH: {{ submission.arch|default:"unknown" }}, ACCEPT_KEYWORDS: {{ submission.global_keywords.all|join:", " }}</a></li>
            {% endfor %}
        </ul>

        <li>ARCH statistics</li>
        <table border="1">
            <th>Arch</th>
            <th>Hosts</th>
            {% for arch, num_hosts in arch_stats %}
                <tr>
                    <td><a href="{% url 'stats:arch_details_url' arch=arch %}">{{ arch }}</a></td>
                    <td>{{ num_hosts }}</td>
                </tr>
            {% endfor %}
        </table>

        <li>Keyword statistics</li>
        <table border="1">
            <th>Keyword</th>
            <th>Hosts</th>
            {% for keyword in keywords %}
                <tr>
                    <td><a href="{{ keyword.get_absolute_url }}">{{ keyword }}</a></td>
                    <td>{{ keyword.num_hosts_fast|default_if_none:"0" }}</td>
                </tr>
            {% endfor %}
        </table>

        <li>Profile statistics</li>
        <table border="1">
            <th>Profile</th>
            <th>Hosts</th>
            {% for profile, num_hosts in profile_stats %}
                <tr>
                    <td><a href="{% url 'stats:profile_details_url' profile=profile %}">{{ profile }}</a></td>
                    <td>{{ num_hosts }}</td>
                </tr>
            {% endfor %}
        </table>

        <li>FEATURE statistics</li>
        <table border="1">
            <th>FEATURE</th>
            <th>Hosts</th>
            {% for feature in features %}
                <tr>
                    <td><a href="{{ feature.get_absolute_url }}">{{ feature }}</a></td>
                    <td>{{ feature.num_hosts_fast|default_if_none:"0" }}</td>
                </tr>
            {% endfor %}
        </table>

        <li>$LANG statistics</li>
        <table border="1">
            <th>$LANG</th>
            <th>Hosts</th>
            {% for lang in langs %}
                <tr>
                    <td>{{ lang }}</td>
                    <td>{{ lang.num_hosts_fast|default_if_none:"0" }}</td>
                </tr>
            {% endfor %}
        </table>
    </ul>
    {% else %}
        <h1>No submissions (and hosts) are present yet.</h1>
    {% endif %}
{% endblock content %}
